===============================
**NeatSeq-Flow** Installation 
===============================

.. include:: links.rst

**Author:** Menachem Sklarz

**Affiliation:** |affiliation|

.. contents:: Table of Contents
   :depth: 2
   :local:
   :backlinks: top


.. _installation_section:


Download and Install
===============================

#. Prerequisites::

    You will need to `git <https://git-scm.com/downloads>`_ and pip installed for the following installation procedure.

#. Clone the package from github::

    git clone https://github.com/bioinfo-core-BGU/neatseq-flow.git

#. You may have to install two `python` dependencies: `yaml` and `bunch`. This can be done with::

    pip install pyyaml bunch

#. Clone the package of modules from github::

    git clone https://github.com/bioinfo-core-BGU/neatseq-flow-modules.git
    

.. Tip:: A NeatSeq-Flow GUI is available. See the detailed `GUI tutorial`_.

.. Note:: You can also download the repository code from the following links:

   * Main **NeatSeq-Flow** source code: https://github.com/bioinfo-core-BGU/neatseq-flow/archive/master.zip
   * Module and workflow repository: https://github.com/bioinfo-core-BGU/neatseq-flow-modules/archive/master.zip

.. _Execution_section:

Executing **NeatSeq-Flow**
===============================

Create a new directory anywhere, `cd` into it and execute the following commands (``$NSF_main`` is the directory where **NeatSeq-Flow** is installed)::

    python $NSF_main/bin/neatseq_flow.py                         \
        --sample_file $NSF_main/Workflows/Sample_sets/PE_tabular.nsfs    \
        --param_file  $NSF_main/Workflows/mapping.yaml       \
        --message     "My first NeatSeq-Flow WF"

.. _install_with_conda:

Install and execute with **Conda**
====================================

.. Attention:: The following instructions are for use with the ``bash`` shell!

#. Install `Miniconda`_ (for python version 2.7).
#. Download the **NeatSeq-Flow** |conda_env|.

   .. tabs::

      .. tab:: wget

         .. code-block:: bash

            wget http://neatseq-flow.readthedocs.io/en/latest/extra/NeatSeq_Flow_conda_env.yaml

      .. tab:: curl

         .. code-block:: bash

            curl http://neatseq-flow.readthedocs.io/en/latest/extra/NeatSeq_Flow_conda_env.yaml > NeatSeq_Flow_Tutorial_Install.yaml

#. Create an environment:

   .. code-block:: bash

      conda-env create -f NeatSeq_Flow_conda_env.yaml

#. Activate the environment:

   .. code-block:: bash

      source activate NeatSeq_Flow

#. Execute the following command to tell **NeatSeq-Flow** where the base conda installation is located:

   .. code-block:: bash

      export CONDA_BASE=$(conda info --root)

#. Make a dir for your project and change into it::

    mkdir first_neatseq_flow_proj; cd first_neatseq_flow_proj

#. Execute **NeatSeq-Flow**:

   .. code-block:: bash

      neatseq_flow.py \
         --sample_file $CONDA_PREFIX/NeatSeq-Flow-Workflows/Sample_sets/PE_tabular.nsfs \
         --param_file $CONDA_PREFIX/NeatSeq-Flow-Workflows/mapping.yaml \
         --message "My first NeatSeq-Flow WF using conda"

    
#. When done, deactivate the environment:

   .. code-block:: bash

      source deactivate

.. Note:: You don't need to have the environment activated in order to execute the scripts!

.. Attention:: See the |tutorial| for a full example of how to use **NeatSeq-Flow**

